<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Distribuidora de Bebidas</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f0f0f0;
    }
    .navbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: #333;
        color: #fff;
        padding: 10px 20px;
    }
    .navbar img {
        border-radius: 50%;
        block-size: 40px;
        inline-size: 40px;
        margin-inline-end: 10px;
    }
    .navbar .logo {
        display: flex;
        align-items: center;
        cursor: pointer;
    }
    .navbar .logo h1 {
        margin: 0;
    }
    .navbar .actions {
        display: flex;
        align-items: center;
    }
    .navbar .actions button {
        background-color: #fff;
        color: #333;
        border: none;
        padding: 10px;
        cursor: pointer;
        margin-inline-start: 10px;
        position: relative;
    }
    .navbar .actions .sacola {
        position: relative;
    }
    .navbar .actions .sacola .item-count {
        position: absolute;
        inset-block-start: -5px;
        inset-inline-end: -5px;
        background-color: red;
        color: white;
        border-radius: 50%;
        padding: 2px 5px;
        font-size: 12px;
    }
    .container {
        inline-size: 80%;
        margin: 20px auto;
        overflow: hidden;
        position: relative;
    }
    .slider {
        display: flex;
        overflow-x: auto;
        scroll-snap-type: x mandatory;
        -webkit-overflow-scrolling: touch; /* Suporte para scrolling suave em iOS */
    }
    .produto {
        flex: 0 0 auto;
        scroll-snap-align: start;
        inline-size: 300px;
        margin-inline-end: 20px;
        background-color: #fff;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
        padding: 20px;
        box-sizing: border-box;
        text-align: center; /* Centraliza o texto e a imagem */
    }
    .produto img {
        max-block-size: 200px; /* Define uma altura máxima para as imagens */
        inline-size: auto; /* Ajusta a largura proporcionalmente */
        display: block;
        margin: 0 auto 10px auto; /* Centraliza a imagem e adiciona margem inferior */
        border-radius: 8px; /* Adiciona borda arredondada à imagem */
    }
    .produto button {
        background-color: #333;
        color: #fff;
        border: none;
        padding: 10px;
        cursor: pointer;
        margin-block-start: 10px;
    }
    h1 {
        text-align: center;
        margin-block-start: 20px;
    }
    .sacola-dropdown {
    position: relative;
}

    .sacola {
        background-color: #fff;
        color: #333;
        border: 1px solid #ccc;
        padding: 10px 20px;
        cursor: pointer;
        border-radius: 8px; /* Cantos arredondados */
    }

    .sacola:hover {
        background-color: #f0f0f0;
    }

    .item-count {
        position: absolute;
        top: -5px;
        right: -5px;
        background-color: red;
        color: white;
        border-radius: 50%;
        padding: 2px 5px;
        font-size: 12px;
    }

    .sacola-content {
        position: absolute;
        top: 40px;
        right: 0;
        background-color: #fff;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
        padding: 10px;
        border-radius: 8px;
        min-width: 200px;
        z-index: 1;
        color: #000; /* Alterar a cor do texto para preto */
    }

    .cart-item {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 10px;
    }

    .cart-item img {
        max-width: 50px;
        max-height: 50px;
        margin-right: 10px;
    }

    .cart-item button {
        background-color: #f44336;
        color: white;
        border: none;
        padding: 5px 10px;
        cursor: pointer;
    }

</style>
</head>
<body>

<!-- Navbar -->
<div class="navbar">
    <div class="logo" onclick="window.location.href='/'">
        <img src="logo.png" alt="Distribuidora Logo">
        <h1>Distribuidora de Bebidas</h1>
    </div>
    <div class="actions" id="user-actions">
        <% if (!user) { %>
            <!-- Botão de Entrar -->
            <button onclick="window.location.href='/login'" style="border-radius: 50%; padding: 10px 20px;">Entrar</button>
        <% } else { %>
            <!-- Link para Conta do Cliente -->
            <a href="/conta-do-cliente">
                <img src="profile.png" alt="Profile Picture">
                <h2>Olá, <%= user.Nome %>!</h2>
            </a>
            <!-- Botão da Sacola -->
            <div class="sacola-dropdown">
                <button class="sacola" onclick="toggleSacolaDropdown()">
                    SACOLA
                    <div class="item-count">0</div>
                </button>
                <div class="sacola-content" style="display: none;">
                    <h3>Sua Sacola</h3>
                    <div id="cart-items"></div>
                    <div id="cart-total">Total: R$ 0.00</div>
                    <button onclick="finalizeOrder()">Finalizar Pedido</button>
                </div>
            </div>
        <% } %>
    </div>
</div>

<!-- Título -->
<h1>Cervejas</h1>
<!-- Slider de Produtos -->
<div class="container">
    <div class="slider" onwheel="handleWheel(event)">
        <div class="produto">
            <img src="/Garrafa_de_Cerveja_Brahma_Chope_300ML_PNG_Transparente_Sem_Fundo.png" alt="Produto 1">
            <h2>Brahma 300ml</h2>
            <p>Garrafa de Cerveja Brahma Chope 300ML.</p>
            <% if (!user) { %>
                <!-- Mostrar mensagem de login -->
                <button onclick="redirectToLogin()" class="adicionar-sacola">Adicionar à sacola</button>
            <% } else { %>
                <!-- Adicionar à sacola -->
                <button onclick="addToCart(88)" class="adicionar-sacola">Adicionar à sacola</button>
            <% } %>
        </div>
        <!-- Repetir para outros produtos -->
    </div>
</div>

<style>
    .adicionar-sacola {
        background-color: #333;
        color: #fff;
        border: none;
        padding: 10px 20px;
        cursor: pointer;
        border-radius: 0;
    }
</style>

<script>
    function handleWheel(event) {
        const delta = Math.sign(event.deltaY);
        const slider = document.querySelector('.slider');
        const larguraProduto = document.querySelector('.produto').offsetWidth + 20; // Largura do produto + margin-right

        if (delta > 0) {
            // Scroll down
            slider.scrollBy({
                left: larguraProduto,
                behavior: 'smooth'
            });
        } else {
            // Scroll up
            slider.scrollBy({
                left: -larguraProduto,
                behavior: 'smooth'
            });
        }
    }

    function redirectToLogin() {
        alert('Você precisa estar logado para adicionar itens à sacola');
        window.location.href = '/login'; // Redirecionar para a página de login
    }
    let cartItems = []; // Array para armazenar itens da sacola

function addToCart(productId) {
    // Aqui você pode adicionar lógica para buscar informações do produto pelo ID, se necessário
    const product = {
        id: productId,
        name: 'Brahma 300ml', // Nome do produto
        price: 3.50, // Preço do produto
        quantity: 1 // Quantidade inicial
    };

    // Verifica se o produto já está na sacola
    const existingItem = cartItems.find(item => item.id === productId);
    if (existingItem) {
        // Se o produto já existe na sacola, aumenta a quantidade
        existingItem.quantity++;
    } else {
        // Caso contrário, adiciona o novo produto à sacola
        cartItems.push(product);
    }

    // Atualiza a contagem de itens no botão da sacola
    updateCartCount();

    // Atualiza a exibição da sacola dropdown
    renderCartItems();
}

function updateCartCount() {
    const itemCount = cartItems.reduce((total, item) => total + item.quantity, 0);
    document.querySelector('.item-count').textContent = itemCount;
}

function renderCartItems() {
    const cartContainer = document.getElementById('cart-items');
    cartContainer.innerHTML = ''; // Limpa o conteúdo anterior

    cartItems.forEach(item => {
        const itemDiv = document.createElement('div');
        itemDiv.classList.add('cart-item');
        itemDiv.innerHTML = `
            <img src="/Garrafa_de_Cerveja_Brahma_Chope_300ML_PNG_Transparente_Sem_Fundo.png" alt="${item.name}">
            <span>${item.name}</span>
            <span>R$ ${item.price.toFixed(2)}</span>
            <input type="number" min="1" value="${item.quantity}" onchange="updateCartItem(${item.id}, this.value)">
            <button onclick="removeCartItem(${item.id})">Remover</button>
        `;
        cartContainer.appendChild(itemDiv);
    });

    // Atualiza o total da sacola
    updateCartTotal();
}

function updateCartItem(productId, newQuantity) {
    const item = cartItems.find(item => item.id === productId);
    if (item) {
        item.quantity = parseInt(newQuantity);
        updateCartCount();
        updateCartTotal();
    }
}

function removeCartItem(productId) {
    cartItems = cartItems.filter(item => item.id !== productId);
    updateCartCount();
    renderCartItems();
}

function updateCartTotal() {
    const total = cartItems.reduce((sum, item) => sum + (item.price * item.quantity), 0);
    document.getElementById('cart-total').textContent = `Total: R$ ${total.toFixed(2)}`;
}

function toggleSacolaDropdown() {
    const sacolaContent = document.querySelector('.sacola-content');
    sacolaContent.style.display = sacolaContent.style.display === 'block' ? 'none' : 'block';
}

function finalizeOrder() {
    if (confirm('Tem certeza que deseja finalizar o pedido?')) {
        // Aqui você pode implementar a lógica para enviar o pedido para o servidor
        // e adicionar na tabela de Pedidos no banco de dados
        alert('Pedido finalizado com sucesso!');
        // Limpa a sacola após finalizar o pedido
        cartItems = [];
        updateCartCount();
        renderCartItems();
        updateCartTotal();
    }
}

document.addEventListener('DOMContentLoaded', () => {
    updateCartCount(); // Atualiza a contagem inicial de itens na sacola
});

</script>

</body>
</html>
